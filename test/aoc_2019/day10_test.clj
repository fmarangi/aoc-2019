(ns aoc-2019.day10-test
  (:require
    [clojure.test :refer :all]
    [aoc-2019.utils :refer [angle]]
    [aoc-2019.day10 :refer :all]))

(deftest calc-normalized-angle
  (is (= (normalize-angle (angle [11 13] [11 12])) 0.0))
  (is (= (normalize-angle (angle [11 13] [11 14])) Math/PI))
  (is (= (normalize-angle (angle [11 13] [12 13])) (* Math/PI 0.5)))
  (is (= (normalize-angle (angle [11 13] [10 13])) (* Math/PI 1.5))))

(deftest calc-detected-asteroids
  (is (= (best-location (parse-input ".#..#
.....
#####
....#
...##")) 8))

  (is (= (best-location (parse-input "......#.#.
#..#.#....
..#######.
.#.#.###..
.#..#.....
..#....#.#
#..#....#.
.##.#..###
##...#..#.
.#....####")) 33))

  (is (= (best-location (parse-input "#.#...#.#.
.###....#.
.#....#...
##.#.#.#.#
....#.#.#.
.##..###.#
..#...##..
..##....##
......#...
.####.###.")) 35))

  (is (= (best-location (parse-input ".#..#..###
####.###.#
....###.#.
..###.##.#
##.##.#.#.
....###..#
..#.#..#.#
#..#.#.###
.##...##.#
.....#.#..")) 41))

  (is (= (best-location (parse-input ".#..##.###...#######
##.############..##.
.#.######.########.#
.###.#######.####.#.
#####.##.#.##.###.##
..#####..#.#########
####################
#.####....###.#.#.##
##.#################
#####.##.###..####..
..######..##.#######
####.##.####...##..#
.#####..#.######.###
##...#.##########...
#.##########.#######
.####.#.###.###.#.##
....##.##.###..#####
.#.#.###########.###
#.#.#.#####.####.###
###.##.####.##.#..##")) 210)))

(deftest vaporize-asteroids
  (is (= (vaporize (parse-input ".#..##.###...#######
##.############..##.
.#.######.########.#
.###.#######.####.#.
#####.##.#.##.###.##
..#####..#.#########
####################
#.####....###.#.#.##
##.#################
#####.##.###..####..
..######..##.#######
####.##.####...##..#
.#####..#.######.###
##...#.##########...
#.##########.#######
.####.#.###.###.#.##
....##.##.###..#####
.#.#.###########.###
#.#.#.#####.####.###
###.##.####.##.#..##") 200) 802)))

(deftest solve-puzzle
  (let [input (slurp "resources/2019/day10.txt")]
    (is (= (part-1 input) 284))
    (is (= (part-2 input) 404))))
